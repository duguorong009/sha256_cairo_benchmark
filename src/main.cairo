%builtins output range_check bitwise

from src.sha256 import (
    sha256,
    finalize_sha256,
)
from starkware.cairo.common.alloc import alloc
from starkware.cairo.common.cairo_builtins import BitwiseBuiltin
from starkware.cairo.common.memcpy import memcpy
from starkware.cairo.common.uint256 import uint256_eq

// ref: https://github.com/cartridge-gg/cairo-sha256/blob/main/tests/test_sha256.cairo#L13
func main{output_ptr: felt*, range_check_ptr, bitwise_ptr: BitwiseBuiltin*}() {
    alloc_locals;

    let (input_text) = alloc();

    assert input_text[0] = 'abcd';
    assert input_text[1] = 'abcd';
    assert input_text[2] = 'abcd';
    assert input_text[3] = 'abcd';
    assert input_text[4] = 'abcd';
    assert input_text[5] = 'abcd';
    assert input_text[6] = 'abcd';
    assert input_text[7] = 'abcd';
    assert input_text[8] = 'abcd';
    assert input_text[9] = 'abcd';
    assert input_text[10] = 'abcd';
    assert input_text[11] = 'abcd';
    assert input_text[12] = 'abcd';
    assert input_text[13] = 'abcd';
    assert input_text[14] = 'abcd';
    assert input_text[15] = 'abcd';
    assert input_text[16] = 'abcd';
    assert input_text[17] = 'abcd';
    assert input_text[18] = 'abcd';
    assert input_text[19] = 'abcd';
    assert input_text[20] = 'abcd';
    assert input_text[21] = 'abcd';
    assert input_text[22] = 'abcd';
    assert input_text[23] = 'abcd';
    assert input_text[24] = 'abcd';
    assert input_text[25] = 'abcd';
    assert input_text[26] = 'abcd';
    assert input_text[27] = 'abcd';
    assert input_text[28] = 'abcd';
    assert input_text[29] = 'abcd';
    assert input_text[30] = 'abcd';
    assert input_text[31] = 'abcd';
    assert input_text[32] = 'abcd';
    assert input_text[33] = 'abcd';
    assert input_text[34] = 'abcd';
    assert input_text[35] = 'abcd';
    assert input_text[36] = 'abcd';
    assert input_text[37] = 'abcd';
    assert input_text[38] = 'abcd';
    assert input_text[39] = 'abcd';
    assert input_text[40] = 'abcd';
    assert input_text[41] = 'abcd';
    assert input_text[42] = 'abcd';
    assert input_text[43] = 'abcd';
    assert input_text[44] = 'abcd';
    assert input_text[45] = 'abcd';
    assert input_text[46] = 'abcd';
    assert input_text[47] = 'abcd';
    assert input_text[48] = 'abcd';
    assert input_text[49] = 'abcd';
    assert input_text[50] = 'abcd';
    assert input_text[51] = 'abcd';
    assert input_text[52] = 'abcd';
    assert input_text[53] = 'abcd';
    assert input_text[54] = 'abcd';
    assert input_text[55] = 'abcd';
    assert input_text[56] = 'abcd';
    assert input_text[57] = 'abcd';
    assert input_text[58] = 'abcd';
    assert input_text[59] = 'abcd';
    assert input_text[60] = 'abcd';
    assert input_text[61] = 'abcd';
    assert input_text[62] = 'abcd';
    assert input_text[63] = 'abcd';
    assert input_text[64] = 'abcd';
    assert input_text[65] = 'abcd';
    assert input_text[66] = 'abcd';
    assert input_text[67] = 'abcd';
    assert input_text[68] = 'abcd';
    assert input_text[69] = 'abcd';
    assert input_text[70] = 'abcd';
    assert input_text[71] = 'abcd';
    assert input_text[72] = 'abcd';
    assert input_text[73] = 'abcd';
    assert input_text[74] = 'abcd';
    assert input_text[75] = 'abcd';
    assert input_text[76] = 'abcd';
    assert input_text[77] = 'abcd';
    assert input_text[78] = 'abcd';
    assert input_text[79] = 'abcd';
    assert input_text[80] = 'abcd';
    assert input_text[81] = 'abcd';
    assert input_text[82] = 'abcd';
    assert input_text[83] = 'abcd';
    assert input_text[84] = 'abcd';
    assert input_text[85] = 'abcd';    
    assert input_text[86] = 'abcd';
    assert input_text[87] = 'abcd';
    assert input_text[88] = 'abcd';
    assert input_text[89] = 'abcd';
    assert input_text[90] = 'abcd';
    assert input_text[91] = 'abcd';
    assert input_text[92] = 'abcd';
    assert input_text[93] = 'abcd';
    assert input_text[94] = 'abcd';
    assert input_text[95] = 'abcd';
    assert input_text[96] = 'abcd';
    assert input_text[97] = 'abcd';
    assert input_text[98] = 'abcd';
    assert input_text[99] = 'abcd';
    assert input_text[100] = 'abcd';
    assert input_text[101] = 'abcd';
    assert input_text[102] = 'abcd';
    assert input_text[103] = 'abcd';
    assert input_text[104] = 'abcd';
    assert input_text[105] = 'abcd';
    assert input_text[106] = 'abcd';
    assert input_text[107] = 'abcd';
    assert input_text[108] = 'abcd';
    assert input_text[109] = 'abcd';
    assert input_text[110] = 'abcd';
    assert input_text[111] = 'abcd';
    assert input_text[112] = 'abcd';
    assert input_text[113] = 'abcd';
    assert input_text[114] = 'abcd';
    assert input_text[115] = 'abcd';
    assert input_text[116] = 'abcd';
    assert input_text[117] = 'abcd';
    assert input_text[118] = 'abcd';
    assert input_text[119] = 'abcd';
    assert input_text[120] = 'abcd';
    assert input_text[121] = 'abcd';
    assert input_text[122] = 'abcd';
    assert input_text[123] = 'abcd';
    assert input_text[124] = 'abcd';
    assert input_text[125] = 'abcd';
    assert input_text[126] = 'abcd';
    assert input_text[127] = 'abcd';
    assert input_text[128] = 'abcd';
    assert input_text[129] = 'abcd';
    assert input_text[130] = 'abcd';
    assert input_text[131] = 'abcd';
    assert input_text[132] = 'abcd';
    assert input_text[133] = 'abcd';
    assert input_text[134] = 'abcd';
    assert input_text[135] = 'abcd';
    assert input_text[136] = 'abcd';
    assert input_text[137] = 'abcd';
    assert input_text[138] = 'abcd';
    assert input_text[139] = 'abcd';
    assert input_text[140] = 'abcd';
    assert input_text[141] = 'abcd';
    assert input_text[142] = 'abcd';
    assert input_text[143] = 'abcd';
    assert input_text[144] = 'abcd';
    assert input_text[145] = 'abcd';
    assert input_text[146] = 'abcd';
    assert input_text[147] = 'abcd';
    assert input_text[148] = 'abcd';
    assert input_text[149] = 'abcd';
    assert input_text[150] = 'abcd';
    assert input_text[151] = 'abcd';
    assert input_text[152] = 'abcd';
    assert input_text[153] = 'abcd';
    assert input_text[154] = 'abcd';
    assert input_text[155] = 'abcd';
    assert input_text[156] = 'abcd';
    assert input_text[157] = 'abcd';
    assert input_text[158] = 'abcd';
    assert input_text[159] = 'abcd';
    assert input_text[160] = 'abcd';
    assert input_text[161] = 'abcd';
    assert input_text[162] = 'abcd';
    assert input_text[163] = 'abcd';
    assert input_text[164] = 'abcd';
    assert input_text[165] = 'abcd';
    assert input_text[166] = 'abcd';
    assert input_text[167] = 'abcd';
    assert input_text[168] = 'abcd';
    assert input_text[169] = 'abcd';
    assert input_text[170] = 'abcd';
    assert input_text[171] = 'abcd';
    assert input_text[172] = 'abcd';
    assert input_text[173] = 'abcd';
    assert input_text[174] = 'abcd';
    assert input_text[175] = 'abcd';
    assert input_text[176] = 'abcd';
    assert input_text[177] = 'abcd';
    assert input_text[178] = 'abcd';
    assert input_text[179] = 'abcd';
    assert input_text[180] = 'abcd';
    assert input_text[181] = 'abcd';
    assert input_text[182] = 'abcd';
    assert input_text[183] = 'abcd';
    assert input_text[184] = 'abcd';
    assert input_text[185] = 'abcd';
    assert input_text[186] = 'abcd';
    assert input_text[187] = 'abcd';
    assert input_text[188] = 'abcd';
    assert input_text[189] = 'abcd';
    assert input_text[190] = 'abcd';
    assert input_text[191] = 'abcd';
    assert input_text[192] = 'abcd';
    assert input_text[193] = 'abcd';
    assert input_text[194] = 'abcd';
    assert input_text[195] = 'abcd';
    assert input_text[196] = 'abcd';
    assert input_text[197] = 'abcd';
    assert input_text[198] = 'abcd';
    assert input_text[199] = 'abcd';
    assert input_text[200] = 'abcd';
    assert input_text[201] = 'abcd';
    assert input_text[202] = 'abcd';
    assert input_text[203] = 'abcd';
    assert input_text[204] = 'abcd';    
    assert input_text[205] = 'abcd';
    assert input_text[206] = 'abcd';
    assert input_text[207] = 'abcd';
    assert input_text[208] = 'abcd';
    assert input_text[209] = 'abcd';
    assert input_text[210] = 'abcd';
    assert input_text[211] = 'abcd';
    assert input_text[212] = 'abcd';
    assert input_text[213] = 'abcd';
    assert input_text[214] = 'abcd';
    assert input_text[215] = 'abcd';
    assert input_text[216] = 'abcd';
    assert input_text[217] = 'abcd';
    assert input_text[218] = 'abcd';
    assert input_text[219] = 'abcd';
    assert input_text[220] = 'abcd';
    assert input_text[221] = 'abcd';
    assert input_text[222] = 'abcd';
    assert input_text[223] = 'abcd';
    assert input_text[224] = 'abcd';
    assert input_text[225] = 'abcd';
    assert input_text[226] = 'abcd';
    assert input_text[227] = 'abcd';
    assert input_text[228] = 'abcd';
    assert input_text[229] = 'abcd';
    assert input_text[230] = 'abcd';
    assert input_text[231] = 'abcd';
    assert input_text[232] = 'abcd';
    assert input_text[233] = 'abcd';
    assert input_text[234] = 'abcd';
    assert input_text[235] = 'abcd';
    assert input_text[236] = 'abcd';
    assert input_text[237] = 'abcd';
    assert input_text[238] = 'abcd';
    assert input_text[239] = 'abcd';
    assert input_text[240] = 'abcd';
    assert input_text[241] = 'abcd';
    assert input_text[242] = 'abcd';
    assert input_text[243] = 'abcd';
    assert input_text[244] = 'abcd';
    assert input_text[245] = 'abcd';
    assert input_text[246] = 'abcd';
    assert input_text[247] = 'abcd';
    assert input_text[248] = 'abcd';
    assert input_text[249] = 'abcd';
    assert input_text[250] = 'abcd';
    assert input_text[251] = 'abcd';
    assert input_text[252] = 'abcd';
    assert input_text[253] = 'abcd';
    assert input_text[254] = 'abcd';
    assert input_text[255] = 'abcd';
    assert input_text[256] = 'abcd';
    assert input_text[257] = 'abcd';
    assert input_text[258] = 'abcd';
    assert input_text[259] = 'abcd';
    assert input_text[260] = 'abcd';
    assert input_text[261] = 'abcd';
    assert input_text[262] = 'abcd';
    assert input_text[263] = 'abcd';
    assert input_text[264] = 'abcd';
    assert input_text[265] = 'abcd';
    assert input_text[266] = 'abcd';
    assert input_text[267] = 'abcd';
    assert input_text[268] = 'abcd';
    assert input_text[269] = 'abcd';
    assert input_text[270] = 'abcd';
    assert input_text[271] = 'abcd';
    assert input_text[272] = 'abcd';
    assert input_text[273] = 'abcd';
    assert input_text[274] = 'abcd';
    assert input_text[275] = 'abcd';
    assert input_text[276] = 'abcd';
    assert input_text[277] = 'abcd';
    assert input_text[278] = 'abcd';
    assert input_text[279] = 'abcd';
    assert input_text[280] = 'abcd';
    assert input_text[281] = 'abcd';
    assert input_text[282] = 'abcd';
    assert input_text[283] = 'abcd';
    assert input_text[284] = 'abcd';
    assert input_text[285] = 'abcd';
    assert input_text[286] = 'abcd';
    assert input_text[287] = 'abcd';
    assert input_text[288] = 'abcd';
    assert input_text[289] = 'abcd';
    assert input_text[290] = 'abcd';
    assert input_text[291] = 'abcd';
    assert input_text[292] = 'abcd';
    assert input_text[293] = 'abcd';
    assert input_text[294] = 'abcd';
    assert input_text[295] = 'abcd';
    assert input_text[296] = 'abcd';
    assert input_text[297] = 'abcd';
    assert input_text[298] = 'abcd';
    assert input_text[299] = 'abcd';
    assert input_text[300] = 'abcd';
    assert input_text[301] = 'abcd';
    assert input_text[302] = 'abcd';
    assert input_text[303] = 'abcd';
    assert input_text[304] = 'abcd';
    assert input_text[305] = 'abcd';
    assert input_text[306] = 'abcd';
    assert input_text[307] = 'abcd';
    assert input_text[308] = 'abcd';
    assert input_text[309] = 'abcd';
    assert input_text[310] = 'abcd';
    assert input_text[311] = 'abcd';
    assert input_text[312] = 'abcd';
    assert input_text[313] = 'abcd';
    assert input_text[314] = 'abcd';
    assert input_text[315] = 'abcd';
    assert input_text[316] = 'abcd';
    assert input_text[317] = 'abcd';
    assert input_text[318] = 'abcd';
    assert input_text[319] = 'abcd';
    assert input_text[320] = 'abcd';
    assert input_text[321] = 'abcd';
    assert input_text[322] = 'abcd';
    assert input_text[323] = 'abcd';
    assert input_text[324] = 'abcd';
    assert input_text[325] = 'abcd';
    assert input_text[326] = 'abcd';
    assert input_text[327] = 'abcd';
    assert input_text[328] = 'abcd';
    assert input_text[329] = 'abcd';
    assert input_text[330] = 'abcd';
    assert input_text[331] = 'abcd';
    assert input_text[332] = 'abcd';
    assert input_text[333] = 'abcd';
    assert input_text[334] = 'abcd';
    assert input_text[335] = 'abcd';
    assert input_text[336] = 'abcd';
    assert input_text[337] = 'abcd';
    assert input_text[338] = 'abcd';
    assert input_text[339] = 'abcd';
    assert input_text[340] = 'abcd';
    assert input_text[341] = 'abcd';
    assert input_text[342] = 'abcd';
    assert input_text[343] = 'abcd';
    assert input_text[344] = 'abcd';
    assert input_text[345] = 'abcd';
    assert input_text[346] = 'abcd';
    assert input_text[347] = 'abcd';
    assert input_text[348] = 'abcd';
    assert input_text[349] = 'abcd';
    assert input_text[350] = 'abcd';
    assert input_text[351] = 'abcd';
    assert input_text[352] = 'abcd';
    assert input_text[353] = 'abcd';
    assert input_text[354] = 'abcd';
    assert input_text[355] = 'abcd';
    assert input_text[356] = 'abcd';
    assert input_text[357] = 'abcd';
    assert input_text[358] = 'abcd';
    assert input_text[359] = 'abcd';
    assert input_text[360] = 'abcd';
    assert input_text[361] = 'abcd';
    assert input_text[362] = 'abcd';
    assert input_text[363] = 'abcd';
    assert input_text[364] = 'abcd';
    assert input_text[365] = 'abcd';
    assert input_text[366] = 'abcd';
    assert input_text[367] = 'abcd';
    assert input_text[368] = 'abcd';
    assert input_text[369] = 'abcd';
    assert input_text[370] = 'abcd';
    assert input_text[371] = 'abcd';
    assert input_text[372] = 'abcd';
    assert input_text[373] = 'abcd';
    assert input_text[374] = 'abcd';
    assert input_text[375] = 'abcd';
    assert input_text[376] = 'abcd';
    assert input_text[377] = 'abcd';
    assert input_text[378] = 'abcd';
    assert input_text[379] = 'abcd';
    assert input_text[380] = 'abcd';
    assert input_text[381] = 'abcd';
    assert input_text[382] = 'abcd';
    assert input_text[383] = 'abcd';
    assert input_text[384] = 'abcd';
    assert input_text[385] = 'abcd';
    assert input_text[386] = 'abcd';
    assert input_text[387] = 'abcd';
    assert input_text[388] = 'abcd';
    assert input_text[389] = 'abcd';
    assert input_text[390] = 'abcd';
    assert input_text[391] = 'abcd';
    assert input_text[392] = 'abcd';
    assert input_text[393] = 'abcd';
    assert input_text[394] = 'abcd';
    assert input_text[395] = 'abcd';
    assert input_text[396] = 'abcd';
    assert input_text[397] = 'abcd';
    assert input_text[398] = 'abcd';
    assert input_text[399] = 'abcd';
    assert input_text[400] = 'abcd';
    assert input_text[401] = 'abcd';
    assert input_text[402] = 'abcd';
    assert input_text[403] = 'abcd';
    assert input_text[404] = 'abcd';
    assert input_text[405] = 'abcd';
    assert input_text[406] = 'abcd';
    assert input_text[407] = 'abcd';
    assert input_text[408] = 'abcd';
    assert input_text[409] = 'abcd';
    assert input_text[410] = 'abcd';
    assert input_text[411] = 'abcd';
    assert input_text[412] = 'abcd';
    assert input_text[413] = 'abcd';
    assert input_text[414] = 'abcd';
    assert input_text[415] = 'abcd';
    assert input_text[416] = 'abcd';
    assert input_text[417] = 'abcd';
    assert input_text[418] = 'abcd';
    assert input_text[419] = 'abcd';
    assert input_text[420] = 'abcd';
    assert input_text[421] = 'abcd';
    assert input_text[422] = 'abcd';
    assert input_text[423] = 'abcd';
    assert input_text[424] = 'abcd';
    assert input_text[425] = 'abcd';
    assert input_text[426] = 'abcd';
    assert input_text[427] = 'abcd';
    assert input_text[428] = 'abcd';
    assert input_text[429] = 'abcd';
    assert input_text[430] = 'abcd';
    assert input_text[431] = 'abcd';
    assert input_text[432] = 'abcd';
    assert input_text[433] = 'abcd';
    assert input_text[434] = 'abcd';
    assert input_text[435] = 'abcd';
    assert input_text[436] = 'abcd';
    assert input_text[437] = 'abcd';
    assert input_text[438] = 'abcd';
    assert input_text[439] = 'abcd';
    assert input_text[440] = 'abcd';
    assert input_text[441] = 'abcd';
    assert input_text[442] = 'abcd';
    assert input_text[443] = 'abcd';
    assert input_text[444] = 'abcd';
    assert input_text[445] = 'abcd';
    assert input_text[446] = 'abcd';
    assert input_text[447] = 'abcd';
    assert input_text[448] = 'abcd';
    assert input_text[449] = 'abcd';
    assert input_text[450] = 'abcd';
    assert input_text[451] = 'abcd';
    assert input_text[452] = 'abcd';
    assert input_text[453] = 'abcd';
    assert input_text[454] = 'abcd';
    assert input_text[455] = 'abcd';
    assert input_text[456] = 'abcd';
    assert input_text[457] = 'abcd';
    assert input_text[458] = 'abcd';
    assert input_text[459] = 'abcd';
    assert input_text[460] = 'abcd';
    assert input_text[461] = 'abcd';
    assert input_text[462] = 'abcd';
    assert input_text[463] = 'abcd';
    assert input_text[464] = 'abcd';
    assert input_text[465] = 'abcd';
    assert input_text[466] = 'abcd';
    assert input_text[467] = 'abcd';
    assert input_text[468] = 'abcd';
    assert input_text[469] = 'abcd';
    assert input_text[470] = 'abcd';
    assert input_text[471] = 'abcd';
    assert input_text[472] = 'abcd';
    assert input_text[473] = 'abcd';
    assert input_text[474] = 'abcd';
    assert input_text[475] = 'abcd';
    assert input_text[476] = 'abcd';
    assert input_text[477] = 'abcd';
    assert input_text[478] = 'abcd';
    assert input_text[479] = 'abcd';
    assert input_text[480] = 'abcd';
    assert input_text[481] = 'abcd';
    assert input_text[482] = 'abcd';
    assert input_text[483] = 'abcd';
    assert input_text[484] = 'abcd';
    assert input_text[485] = 'abcd';
    assert input_text[486] = 'abcd';
    assert input_text[487] = 'abcd';
    assert input_text[488] = 'abcd';
    assert input_text[489] = 'abcd';
    assert input_text[490] = 'abcd';
    assert input_text[491] = 'abcd';
    assert input_text[492] = 'abcd';
    assert input_text[493] = 'abcd';
    assert input_text[494] = 'abcd';
    assert input_text[495] = 'abcd';
    assert input_text[496] = 'abcd';
    assert input_text[497] = 'abcd';
    assert input_text[498] = 'abcd';
    assert input_text[499] = 'abcd';
    assert input_text[500] = 'abcd';
    assert input_text[501] = 'abcd';
    assert input_text[502] = 'abcd';
    assert input_text[503] = 'abcd';
    assert input_text[504] = 'abcd';
    assert input_text[505] = 'abcd';
    assert input_text[506] = 'abcd';
    assert input_text[507] = 'abcd';
    assert input_text[508] = 'abcd';
    assert input_text[509] = 'abcd';
    assert input_text[510] = 'abcd';
    assert input_text[511] = 'abcd';
    
    let (local sha256_ptr: felt*) = alloc();
    let sha256_ptr_start = sha256_ptr;
    let (hash) = sha256{sha256_ptr=sha256_ptr}(input_text, 2048);
    finalize_sha256(sha256_ptr_start=sha256_ptr_start, sha256_ptr_end=sha256_ptr);

    return ();
}